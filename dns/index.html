<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNS Rebind Resolver Documentation</title>
    <style>
        :root {
            --bg-body: #0f1117;
            --bg-card: #161b22;
            --bg-code: #0d1117;
            --border-color: #30363d;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --accent-color: #58a6ff;
            --accent-hover: #79c0ff;
            --code-green: #7ee787;
            --code-blue: #79c0ff;
            --code-purple: #d2a8ff;
            --code-red: #ff7b72;
            --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-body);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Header */
        header {
            margin-bottom: 3rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1.5rem;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #ffffff;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Sections */
        section {
            margin-bottom: 3rem;
        }

        h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #ffffff;
            border-left: 4px solid var(--accent-color);
            padding-left: 1rem;
        }

        h3 {
            font-size: 1.1rem;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        /* Code Blocks & Typography */
        code {
            font-family: var(--font-mono);
            background-color: rgba(110, 118, 129, 0.4);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--text-primary);
        }

        pre {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin-bottom: 1.5rem;
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: var(--text-primary);
        }

        /* Syntax Highlighting Simulators */
        .token-keyword { color: var(--accent-color); }
        .token-string { color: var(--code-green); }
        .token-comment { color: var(--text-secondary); font-style: italic; }
        .token-var { color: var(--code-purple); }
        .token-error { color: var(--code-red); }

        /* Lists */
        ul {
            list-style-position: inside;
            margin-bottom: 1.5rem;
            color: var(--text-secondary);
        }

        li {
            margin-bottom: 0.5rem;
        }

        li strong {
            color: var(--text-primary);
        }

        /* Cards/Callouts */
        .note {
            background-color: rgba(56, 139, 253, 0.15);
            border-left: 4px solid var(--accent-color);
            padding: 1rem;
            border-radius: 0 4px 4px 0;
            margin-bottom: 1.5rem;
        }

        .note-title {
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            display: block;
        }

        /* Tables for params */
        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
        }

        .param-table th, .param-table td {
            text-align: left;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .param-table th {
            background-color: #21262d;
            color: var(--text-primary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .param-table td {
            color: var(--text-secondary);
        }

        .tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            font-family: var(--font-mono);
        }
        .tag-req { background: rgba(210, 168, 255, 0.15); color: var(--code-purple); }
        .tag-opt { background: rgba(126, 231, 135, 0.15); color: var(--code-green); }
        .tag-special { background: rgba(255, 123, 114, 0.15); color: var(--code-red); }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>DNS Rebind Generator</h1>
        <div class="subtitle">Dynamic DNS resolution control for testing and security research.</div>
    </header>

    <section>
        <h2>Base Endpoints</h2>
        <p>The service listens on the following wildcard domains. All configuration is done via the subdomain string.</p>
        <pre><code><span class="token-var">&lt;pattern&gt;</span>.<span class="token-var">&lt;id&gt;</span>.dns.is-now.online
<span class="token-var">&lt;pattern&gt;</span>.<span class="token-var">&lt;id&gt;</span>.rdns.is-now.online</code></pre>
    </section>

    <section>
        <h2>Pattern Construction</h2>
        <p>The <code>&lt;pattern&gt;</code> controls the sequence of IP addresses returned by the resolver. It is constructed by joining <strong>tokens</strong> with a dash (<code>-</code>).</p>

        <table class="param-table">
            <thead>
                <tr>
                    <th>Token</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>i&lt;ip_hex&gt;</code></td>
                    <td><span class="tag tag-req">Resolution</span></td>
                    <td>
                        IP address in hexadecimal format. <br>
                        Example: <code>i7f000001</code> resolves to <code>127.0.0.1</code>.
                    </td>
                </tr>
                <tr>
                    <td><code>d</code></td>
                    <td><span class="tag tag-special">Resolution</span></td>
                    <td>
                        <strong>Drop / No Data.</strong> Returns an empty response (NODATA). Useful for testing fallback behaviors.
                    </td>
                </tr>
                <tr>
                    <td><code>x</code></td>
                    <td><span class="tag tag-special">Resolution</span></td>
                    <td>
                        <strong>NXDOMAIN.</strong> Returns a "Non-Existent Domain" error.
                    </td>
                </tr>
                <tr>
                    <td><code>&lt;count&gt;</code></td>
                    <td><span class="tag tag-opt">Modifier</span></td>
                    <td>
                        <strong>Must follow a resolution token (i, d, or x).</strong> Determines how many times that result is returned before moving to the next one. Defaults to <code>1</code>.
                    </td>
                </tr>
                <tr>
                    <td><code>r</code></td>
                    <td><span class="tag tag-opt">Control</span></td>
                    <td>
                        <strong>Repeat Flag.</strong> Must be at the very end of the string. If present, the sequence restarts from the beginning after completion. If absent, the resolver sticks to the last result forever.
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="note">
            <span class="note-title">Validation Note</span>
            Any request with invalid syntax or malformed tokens will result in an <code>NXDOMAIN</code> response.
        </div>
    </section>

    <section>
        <h2>Examples</h2>
        
        <h3>1. Static Resolution</h3>
        <p>Return <code>127.0.0.1</code> every time.</p>
        <pre><code>i7f000001.myid.dns.is-now.online</code></pre>

        <h3>2. Basic Rebind (One-way)</h3>
        <p>Return <code>127.0.0.1</code> once, then switch to <code>8.8.8.8</code> (3 times), then stay at <code>8.8.8.8</code> forever.</p>
        <pre><code><span class="token-comment"># 127.0.0.1 (x1) -> 8.8.8.8 (x3) -> [Lock on 8.8.8.8]</span>
i7f000001-i08080808-3.attacker.dns.is-now.online</code></pre>

        <h3>3. Error & Drop Testing</h3>
        <p>Return <code>127.0.0.1</code> once, then fail with <code>NXDOMAIN</code> twice, then return <code>NODATA</code> (Drop) 5 times, then repeat.</p>
        <pre><code><span class="token-comment"># 127.0.0.1 (x1) -> NXDOMAIN (x2) -> NODATA (x5) -> Repeat</span>
i7f000001-x-2-d-5-r.attacker.dns.is-now.online</code></pre>
    </section>

    <section>
        <h2>Session Management</h2>
        
        <h3>The ID Parameter</h3>
        <p>The <code>&lt;id&gt;</code> component is a user-defined namespace used to track the state of your request counts. This prevents your tests from being polluted by other users.</p>
        <ul>
            <li><strong>Uniqueness:</strong> Use a random string or a unique name (e.g., <code>my_test_v1</code>).</li>
            <li><strong>Scope:</strong> Request counts are shared across all patterns using the same ID.</li>
            <li><strong>TTL:</strong> An ID session persists for <strong>24 hours</strong> from the first request.</li>
        </ul>

        <h3>Resetting State</h3>
        <p>To reset the request counters for a specific ID without waiting for the timeout, query the <code>reset</code> keyword.</p>
        <pre><code>reset.<span class="token-var">&lt;your_id&gt;</span>.dns.is-now.online</code></pre>
    </section>

</div>

</body>
</html>
